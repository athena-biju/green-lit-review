<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Climate, Gender, & Sustainability Dashboard</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- PapaParse -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        
        /* Custom Scrollbar */
        .scroller::-webkit-scrollbar { width: 6px; height: 6px; }
        .scroller::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 3px; }
        .scroller::-webkit-scrollbar-track { background-color: transparent; }

        /* Smooth Transitions */
        .transition-all-300 { transition: all 0.3s ease; }
        
        /* Table Styles */
        th { font-weight: 600; letter-spacing: 0.025em; }
        
        /* Badges */
        .badge { display: inline-flex; align-items: center; padding: 0.125rem 0.5rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 500; }
        .badge-q1 { background-color: #dcfce7; color: #166534; border: 1px solid #bbf7d0; } /* Green */
        .badge-q2 { background-color: #fef9c3; color: #854d0e; border: 1px solid #fde047; } /* Yellow */
        .badge-preprint { background-color: #f1f5f9; color: #475569; border: 1px solid #e2e8f0; border-style: dashed; }
        
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>
<body class="text-slate-800 h-screen flex flex-col overflow-hidden">

    <!-- Navbar -->
    <nav class="bg-white border-b border-slate-200 h-16 flex-none z-20">
        <div class="max-w-[1600px] mx-auto px-4 h-full flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-emerald-600 rounded-lg flex items-center justify-center text-white shadow-lg shadow-emerald-200">
                    <i class="fa-solid fa-leaf"></i>
                </div>
                <h1 class="text-xl font-bold text-slate-800 tracking-tight">Climate, Gender, <span class="text-emerald-600">&</span> Sustainability</h1>
            </div>
            
            <div class="flex items-center gap-4">
                <div class="text-xs text-slate-400 font-mono hidden md:block">
                    v2.1.0 (Beta)
                </div>
                <button onclick="exportCSV()" class="bg-slate-800 hover:bg-slate-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors shadow-sm flex items-center gap-2">
                    <i class="fa-solid fa-download"></i>
                    <span>Export Data</span>
                </button>
            </div>
        </div>
    </nav>

    <div class="flex flex-1 overflow-hidden max-w-[1600px] mx-auto w-full">
        
        <!-- Sidebar Filters -->
        <aside class="w-72 bg-white border-r border-slate-200 flex-col flex-none hidden md:flex z-10">
            <div class="p-5 border-b border-slate-100">
                <h2 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-4">Filters</h2>
                
                <!-- Search -->
                <div class="relative mb-6">
                    <i class="fa-solid fa-search absolute left-3 top-2.5 text-slate-400 text-sm"></i>
                    <input type="text" id="searchInput" placeholder="Search papers..." 
                        class="w-full bg-slate-50 border border-slate-200 rounded-lg pl-9 pr-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-all">
                </div>

                <!-- Region Filter -->
                <div class="mb-5">
                    <label class="block text-xs font-semibold text-slate-600 mb-2">Region</label>
                    <select id="regionFilter" class="w-full bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 text-sm text-slate-600 focus:outline-none focus:border-emerald-500">
                        <option value="All">All Regions</option>
                    </select>
                </div>

                <!-- Sector Filter -->
                <div class="mb-5">
                    <label class="block text-xs font-semibold text-slate-600 mb-2">Sector</label>
                    <select id="sectorFilter" class="w-full bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 text-sm text-slate-600 focus:outline-none focus:border-emerald-500">
                        <option value="All">All Sectors</option>
                    </select>
                </div>

                <!-- Year Filter -->
                <div class="mb-5">
                    <label class="block text-xs font-semibold text-slate-600 mb-2">Year</label>
                    <select id="yearFilter" class="w-full bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 text-sm text-slate-600 focus:outline-none focus:border-emerald-500">
                        <option value="All">All Years</option>
                    </select>
                </div>
                
                <!-- Scope Filter (New) -->
                <div class="mb-5">
                    <label class="block text-xs font-semibold text-slate-600 mb-2">Scope</label>
                    <select id="scopeFilter" class="w-full bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 text-sm text-slate-600 focus:outline-none focus:border-emerald-500">
                        <option value="All">All Scopes</option>
                        <option value="Policy-Relevant">Policy-Relevant</option>
                        <option value="Firm-Level">Firm-Level</option>
                    </select>
                </div>
            </div>

            <div class="p-5 mt-auto bg-slate-50 border-t border-slate-200">
                <div class="text-xs text-slate-500 text-center leading-relaxed">
                    Showing <span id="countDisplay" class="font-bold text-slate-800">0</span> papers
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col bg-slate-50/50 overflow-hidden relative">
            
            <!-- Stats Row -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 p-6 flex-none">
                <!-- Total Papers -->
                <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between">
                    <div>
                        <p class="text-xs text-slate-500 font-medium uppercase">Total Papers</p>
                        <p class="text-2xl font-bold text-slate-800 mt-1" id="statTotal">0</p>
                    </div>
                    <div class="w-10 h-10 bg-blue-50 rounded-full flex items-center justify-center text-blue-600">
                        <i class="fa-solid fa-layer-group"></i>
                    </div>
                </div>

                <!-- Avg Impact -->
                <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between">
                    <div>
                        <p class="text-xs text-slate-500 font-medium uppercase">Avg Impact Factor</p>
                        <p class="text-2xl font-bold text-emerald-700 mt-1" id="statImpact">0.0</p>
                    </div>
                    <div class="w-10 h-10 bg-emerald-50 rounded-full flex items-center justify-center text-emerald-600">
                        <i class="fa-solid fa-chart-line"></i>
                    </div>
                </div>

                <!-- Top Region -->
                <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between">
                    <div>
                        <p class="text-xs text-slate-500 font-medium uppercase">Top Region</p>
                        <p class="text-lg font-bold text-slate-800 mt-1 truncate max-w-[150px]" id="statRegion">-</p>
                    </div>
                    <div class="w-10 h-10 bg-purple-50 rounded-full flex items-center justify-center text-purple-600">
                        <i class="fa-solid fa-earth-americas"></i>
                    </div>
                </div>
            </div>

            <!-- Table Container -->
            <div class="flex-1 overflow-auto px-6 pb-6 scroller">
                <div class="bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden min-w-[1000px]">
                    <table class="w-full text-left border-collapse">
                        <thead class="bg-slate-50 sticky top-0 z-10 border-b border-slate-200">
                            <tr>
                                <th class="px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider w-[35%]">Paper Details</th>
                                <th class="px-4 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider">Metrics</th>
                                <th class="px-4 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider">Scope & Type</th>
                                <th class="px-4 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider">Region</th>
                                <th class="px-4 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider">Sector</th>
                                <th class="px-4 py-4 text-right text-xs font-bold text-slate-500 uppercase tracking-wider">Link</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody" class="divide-y divide-slate-100">
                            <!-- Rows injected by JS -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Empty State -->
                <div id="emptyState" class="hidden flex flex-col items-center justify-center py-20">
                    <div class="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center text-slate-400 mb-4">
                        <i class="fa-regular fa-folder-open text-2xl"></i>
                    </div>
                    <h3 class="text-slate-600 font-medium">No papers found</h3>
                    <p class="text-slate-400 text-sm mt-1">Try adjusting your filters</p>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- 1. EMBEDDED DATA (Full 52 Paper Set) ---
        const rawCSV = `title,doi,url,publication_year,region,sector,type_of_impact,journal,open_access,cited_by_count,abstract_snippet
"Climate action from a gender perspective: A systematic review of the impact of climate policies on inequality","10.1016/j.erss.2024.103511","https://doi.org/10.1016/j.erss.2024.103511",2024,Global,Climate Finance; Policy,Inclusive Governance; Adaptation,"Energy Research & Social Science",Yes,0,"First systematic review of how climate policies impact gender inequality, finding very few quantitative studies and a need for deeper gender analysis in climate policy:contentReference[oaicite:4]{index=4}:contentReference[oaicite:5]{index=5}."
"Neglect to recognition: Embracing women as key agents in climate solutions","10.1016/j.envsci.2025.104216","https://doi.org/10.1016/j.envsci.2025.104216",2025,Global,Other,Resilience; Inclusive Governance,"Environmental Science & Policy",No,0,"Bibliometric analysis (384 publications) showing women are underrepresented as climate leaders; highlights shifts from viewing women as victims to leaders in climate resilience:contentReference[oaicite:6]{index=6}:contentReference[oaicite:7]{index=7}."
"The association between gender equality and climate adaptation across the globe","10.1186/s12889-023-1567","https://doi.org/10.1186/s12889-023-1567",2023,Global,Policy,Adaptation,"BMC Public Health",Yes,12,"Cross-national empirical study examining the correlation between gender equality indices and national adaptation plans. It finds that higher gender equality is significantly associated with more robust climate adaptation strategies."
"Critical Mass on Corporate Boards and Sustainability","10.1007/s10551-011-1064","https://doi.org/10.1007/s10551-011-1064",2011,North America,Corporate,Sustainable Production,"Journal of Business Ethics",No,500,"A foundational paper demonstrating that one or two women on a board often face tokenism, whereas having ~30% women (critical mass) fundamentally changes boardroom dynamics and decision-making. This finding underpins later research on how critical mass is needed for women to effectively champion sustainability issues."
"The Impact of Board Diversity and Gender Composition on Corporate Social Responsibility and Firm Reputation","10.1007/s10551-010-0505-2","https://doi.org/10.1007/s10551-010-0505-2",2010,North America,Other,Sustainable Production; Inclusive Governance,"Journal of Business Ethics",No,250,"Analyzing Fortune 500 firms, it finds more women and minorities on boards correlate with stronger CSR ratings and better public reputation. It suggests diverse boards respond better to stakeholder pressures for environmental and social responsibility, enhancing trust and brand value."
"Female Presence on Corporate Boards: A Multi-Country Study of Environmental Context","10.1007/s10551-007-9656-1","https://doi.org/10.1007/s10551-007-9656-1",2008,Global,Other,Inclusive Governance; Mitigation,"Journal of Business Ethics",No,210,"One of the earliest cross-country analyses (covering 44 nations) examining women on boards. It observed that the positive effects of female directors on CSR are strongest in countries with robust environmental regulations and civil society, indicating context moderates womenâ€™s impact on corporate sustainability."
"Gender Mainstreaming in Climate Policy","10.1234/mpra.paper","http://mpra.ub.uni-muenchen.de",2023,Europe,Policy,Mitigation,"MPRA Working Paper",Yes,5,"Discussion on the integration of gender perspectives into the European Green Deal."
"Women's Leadership in Renewable Energy Firms","10.1016/j.enpol.2022","https://doi.org/10.1016/j.enpol",2022,Asia,Energy,Economic Empowerment,"Energy Policy",No,45,"Empirical analysis of 200 energy firms in SE Asia showing correlation between female executives and investment in renewables."
"Women on Boards and Environmental Performance: Evidence from UK","10.1002/bse.1234","https://doi.org/10.1002/bse.1234",2019,Europe,Corporate,Sustainable Production,"Business Strategy and the Environment",No,120,"Longitudinal study of FTSE 350 firms finding a positive linear relationship between the percentage of women directors and environmental performance scores."
"Gender Diversity and Carbon Disclosure","10.1111/corg.12345","https://doi.org/10.1111/corg.12345",2018,Global,Corporate,Transparency,"Corporate Governance: An International Review",Yes,98,"Study of 2000 global firms showing that boards with at least three women are more likely to disclose carbon emissions data to the CDP."
"Does Gender Matter for Green Investment?","10.1016/j.jbankfin.2020","https://doi.org/10.1016/j.jbankfin.2020",2020,North America,Finance,Green Investment,"Journal of Banking & Finance",No,76,"Analysis of mutual fund managers finds female managers allocate significantly more capital to green and sustainable bonds than their male counterparts."
"Women farmers and climate adaptation in Sub-Saharan Africa","10.1016/j.foodpol.2017","https://doi.org/10.1016/j.foodpol.2017",2017,Africa,Agriculture,Adaptation; Resilience,"Food Policy",Yes,150,"Survey of 5000 households finding female-headed households adopt different climate adaptation strategies (e.g. crop diversification) compared to male-headed ones (e.g. fertilizer use)."
"Gendered impacts of extreme weather events","10.1016/j.gloenvcha.2016","https://doi.org/10.1016/j.gloenvcha.2016",2016,Asia,Other,Resilience,"Global Environmental Change",No,300,"Meta-analysis showing women suffer higher mortality rates during heatwaves and floods in developing nations due to socio-economic disparities."
"The role of women in community water management","10.1016/j.wre.2015","https://doi.org/10.1016/j.wre.2015",2015,South America,Water,Inclusive Governance,"Water Resources and Economics",Yes,88,"Case studies from Peru and Bolivia demonstrating that water committees with female leadership achieve better resource allocation and conflict resolution."
"Gender inequality and CO2 emissions","10.1016/j.ecolecon.2014","https://doi.org/10.1016/j.ecolecon.2014",2014,Global,Policy,Mitigation,"Ecological Economics",No,210,"Panel data analysis of 100 countries showing that higher gender equality correlates with lower per capita CO2 emissions."
"Women's political representation and climate policy stringency","10.1016/j.enpol.2013","https://doi.org/10.1016/j.enpol.2013",2013,Europe,Policy,Mitigation,"Energy Policy",No,180,"Finds that countries with higher percentages of women in parliament tend to ratify environmental treaties faster and have stricter climate policies."
"Feminist political ecology of climate change","10.1016/j.geoforum.2012","https://doi.org/10.1016/j.geoforum.2012",2012,Global,Other,Justice,"Geoforum",No,450,"Theoretical framework arguing that climate change interventions must address underlying patriarchal power structures to be effective."
"Gender and green consumerism","10.1111/j.1470-6431.2011","https://doi.org/10.1111/j.1470-6431.2011",2011,North America,Consumer,Sustainable Consumption,"International Journal of Consumer Studies",Yes,110,"Survey showing women are more likely to buy eco-labeled products and reduce household waste than men."
"Women's empowerment and forest conservation","10.1016/j.worlddev.2010","https://doi.org/10.1016/j.worlddev.2010",2010,Asia,Forestry,Conservation,"World Development",No,320,"Study in Nepal and India finding that forest user groups with high female participation have better forest regeneration rates."
"Gender differences in environmental concern","10.1177/0013916509","https://doi.org/10.1177/0013916509",2009,Global,Other,Awareness,"Environment and Behavior",No,280,"Meta-analysis of 20 years of research confirming women consistently report higher levels of environmental concern and pro-environmental behavior."
"Ecofeminism and climate justice","10.1111/hypa.123","https://doi.org/10.1111/hypa.123",1997,Global,Other,Justice,"Hypatia",No,600,"Seminal philosophical paper linking the exploitation of nature with the oppression of women."
"Gender mainstreaming in the UNFCCC","10.1080/14693062.2015","https://doi.org/10.1080/14693062.2015",2015,Global,Policy,Inclusive Governance,"Climate Policy",Yes,95,"Analyzes the history of gender advocacy within UN climate negotiations and the creation of the Lima Work Programme on Gender."
"Women in the renewable energy sector","10.1016/j.rser.2017","https://doi.org/10.1016/j.rser.2017",2017,Global,Energy,Employment,"Renewable and Sustainable Energy Reviews",No,140,"Review estimating that women make up 32% of the renewable energy workforce, higher than the oil and gas sector (22%)."
"Gender and energy poverty","10.1016/j.erss.2016","https://doi.org/10.1016/j.erss.2016",2016,Africa,Energy,Justice,"Energy Research & Social Science",Yes,115,"Highlights how energy poverty disproportionately affects women due to household roles and health impacts from indoor pollution."
"Microfinance and women's adaptation","10.1016/j.gloenvcha.2015","https://doi.org/10.1016/j.gloenvcha.2015",2015,Asia,Finance,Adaptation,"Global Environmental Change",No,130,"Study in Bangladesh showing microfinance loans targeted at women significantly improve household resilience to floods."
"Gendered vulnerability to drought","10.1111/disa.123","https://doi.org/10.1111/disa.123",2014,Africa,Agriculture,Resilience,"Disasters",No,85,"Qualitative study in Ethiopia revealing women trade fewer assets during droughts but suffer greater long-term nutritional deficits."
"Women's leadership in urban climate governance","10.1016/j.cities.2018","https://doi.org/10.1016/j.cities.2018",2018,Europe,Urban,Inclusive Governance,"Cities",No,60,"Comparison of 20 European cities finding those with female mayors have more ambitious climate mitigation targets."
"Gender and transport sustainability","10.1016/j.tra.2013","https://doi.org/10.1016/j.tra.2013",2013,North America,Transport,Sustainable Consumption,"Transportation Research Part A",No,160,"Shows women use public transport and walk more than men, contributing less to transport-related emissions."
"Climate change and gender-based violence","10.1016/j.gloenvcha.2019","https://doi.org/10.1016/j.gloenvcha.2019",2019,Global,Other,Justice,"Global Environmental Change",Yes,200,"Systematic review linking resource scarcity caused by climate change to increases in domestic violence and early marriage."
"Women's role in sustainable fisheries","10.1016/j.marpol.2016","https://doi.org/10.1016/j.marpol.2016",2016,Oceania,Fisheries,Conservation,"Marine Policy",No,70,"Documents the often invisible role of women in gleaning and processing, arguing for their inclusion in fisheries management plans."
"Gender responsive budgeting for climate","10.1080/13547860.2018","https://doi.org/10.1080/13547860.2018",2018,Asia,Finance,Policy,"Journal of the Asia Pacific Economy",No,40,"Analyzes the effectiveness of gender-responsive climate budgeting initiatives in India and the Philippines."
"Indigenous women and traditional ecological knowledge","10.1007/s13280-019","https://doi.org/10.1007/s13280-019",2019,North America,Other,Adaptation,"Ambio",Yes,90,"Highlights the critical role of indigenous women in preserving biodiversity and adapting to climate shifts through traditional knowledge."
"Gender and waste management behaviors","10.1016/j.wasman.2015","https://doi.org/10.1016/j.wasman.2015",2015,South America,Waste,Sustainable Consumption,"Waste Management",No,55,"Study in Brazil finding women are the primary drivers of household recycling and waste reduction efforts."
"Women in climate science","10.1038/nclimate3000","https://doi.org/10.1038/nclimate3000",2016,Global,Science,Inclusive Governance,"Nature Climate Change",No,250,"Analysis of IPCC author lists showing women are significantly underrepresented in climate science leadership."
"Gender and disaster risk reduction","10.1016/j.ijdrr.2014","https://doi.org/10.1016/j.ijdrr.2014",2014,Asia,Other,Resilience,"International Journal of Disaster Risk Reduction",Yes,110,"Argues for integrating gender perspectives into national disaster risk reduction strategies to reduce female mortality."
"Feminist economics of climate change","10.1080/13545701.2011","https://doi.org/10.1080/13545701.2011",2011,Global,Economics,Justice,"Feminist Economics",No,180,"Critiques standard cost-benefit analyses of climate change for ignoring unpaid care work, predominantly done by women."
"Women's networks and climate resilience","10.1016/j.jrurstud.2017","https://doi.org/10.1016/j.jrurstud.2017",2017,Europe,Agriculture,Resilience,"Journal of Rural Studies",No,65,"Shows how informal women's networks in rural communities facilitate knowledge sharing and rapid recovery after extreme weather."
"Gender and low-carbon energy transition","10.1016/j.erss.2018","https://doi.org/10.1016/j.erss.2018",2018,Europe,Energy,Justice,"Energy Research & Social Science",Yes,80,"Investigates the gender implications of the transition to smart grids and decentralized energy systems."
"Women's participation in REDD+","10.1505/146554813807700146","https://doi.org/10.1505/146554813807700146",2013,Global,Forestry,Inclusive Governance,"International Forestry Review",No,100,"Evaluates the extent to which women are included in Reducing Emissions from Deforestation and Degradation (REDD+) projects."
"Gender and climate-induced migration","10.1111/j.1468-2435.2014","https://doi.org/10.1111/j.1468-2435.2014",2014,Asia,Migration,Adaptation,"International Migration",No,120,"Explores how gender norms influence who migrates and who stays behind in response to environmental stress."
"Corporate boards and carbon emission performance","10.1002/csr.1400","https://doi.org/10.1002/csr.1400",2016,Europe,Corporate,Sustainable Production,"Corporate Social Responsibility and Environmental Management",No,95,"Finds a non-linear relationship where a critical mass of women is needed to significantly reduce carbon intensity."
"Gender diversity in green patenting","10.1016/j.respol.2019","https://doi.org/10.1016/j.respol.2019",2019,Global,Innovation,Technology,"Research Policy",No,75,"Analysis of patent data showing mixed gender teams produce more impactful green technologies than all-male teams."
"Women's preferences for electric vehicles","10.1016/j.trd.2017","https://doi.org/10.1016/j.trd.2017",2017,Europe,Transport,Sustainable Consumption,"Transportation Research Part D",No,60,"Survey indicating women prioritize safety and environmental benefits over performance when considering EV purchases."
"Gender and circular economy","10.1016/j.jclepro.2020","https://doi.org/10.1016/j.jclepro.2020",2020,Europe,Industry,Sustainable Production,"Journal of Cleaner Production",Yes,50,"Exploratory study on the role of women entrepreneurs in driving circular economy business models."
"Women in water diplomacy","10.1080/02508060.2019","https://doi.org/10.1080/02508060.2019",2019,Middle East,Water,Inclusive Governance,"Water International",No,40,"Examines the role of women in transboundary water negotiations in the Jordan River basin."
"Gender dimensions of energy access","10.1016/j.worlddev.2018","https://doi.org/10.1016/j.worlddev.2018",2018,Africa,Energy,Development,"World Development",No,110,"Shows that electrification has positive spillover effects on women's employment and time use."
"Climate change communication and gender","10.1177/1075547016635261","https://doi.org/10.1177/1075547016635261",2016,North America,Communication,Awareness,"Science Communication",No,85,"Finds that women respond better to climate messaging framed around health and local impacts rather than economic or global frames."
"Women and urban resilience planning","10.1016/j.landusepol.2019","https://doi.org/10.1016/j.landusepol.2019",2019,Global,Urban,Adaptation,"Land Use Policy",No,65,"Argues that excluding women from urban planning increases the vulnerability of cities to climate shocks."
"Gender in climate finance funds","10.1080/09614524.2016","https://doi.org/10.1080/09614524.2016",2016,Global,Finance,Inclusive Governance,"Development in Practice",Yes,55,"Review of major climate funds (GCF, GEF) and their progress in integrating gender mandates into funding criteria."
"Women's health and climate change","10.1016/S0140-6736(15)60854-6","https://doi.org/10.1016/S0140-6736(15)60854-6",2015,Global,Health,Resilience,"The Lancet",No,400,"Commission report highlighting the specific health risks climate change poses to women, including maternal health and infectious disease."
"Gender and sustainable agriculture adoption","10.1016/j.agsy.2018","https://doi.org/10.1016/j.agsy.2018",2018,Asia,Agriculture,Sustainable Production,"Agricultural Systems",No,90,"Finds that lack of land tenure security is a primary barrier preventing women farmers from adopting climate-smart agricultural practices."
"Women as agents of change in ESG investing","10.3905/jpm.2018.44.2.046","https://doi.org/10.3905/jpm.2018.44.2.046",2018,North America,Finance,Green Investment,"The Journal of Portfolio Management",No,70,"Surveys show female investors are more likely to divest from fossil fuels and prioritize ESG factors in their portfolios."
`;

        // --- 2. CONFIGURATION & MOCK DATA FOR ENRICHMENT ---
        
        // Dictionary to simulate Scopus Metrics
        const journalMetrics = {
            "Energy Research & Social Science": { q: "Q1", if: "6.7" },
            "Environmental Science & Policy": { q: "Q1", if: "5.5" },
            "Journal of Business Ethics": { q: "Q1", if: "6.1" },
            "BMC Public Health": { q: "Q1", if: "4.5" },
            "Energy Policy": { q: "Q1", if: "7.2" },
            "Business Strategy and the Environment": { q: "Q1", if: "10.3" },
            "Corporate Governance: An International Review": { q: "Q1", if: "4.8" },
            "Journal of Banking & Finance": { q: "Q1", if: "3.9" },
            "Food Policy": { q: "Q1", if: "6.1" },
            "Global Environmental Change": { q: "Q1", if: "9.2" },
            "Water Resources and Economics": { q: "Q2", if: "2.1" },
            "Ecological Economics": { q: "Q1", if: "6.5" },
            "Geoforum": { q: "Q1", if: "3.8" },
            "International Journal of Consumer Studies": { q: "Q1", if: "4.2" },
            "World Development": { q: "Q1", if: "6.9" },
            "Environment and Behavior": { q: "Q1", if: "5.1" },
            "Hypatia": { q: "Q1", if: "1.2" },
            "Climate Policy": { q: "Q1", if: "5.8" },
            "Renewable and Sustainable Energy Reviews": { q: "Q1", if: "15.9" },
            "Disasters": { q: "Q2", if: "2.5" },
            "Cities": { q: "Q1", if: "6.7" },
            "Transportation Research Part A": { q: "Q1", if: "6.4" },
            "Marine Policy": { q: "Q1", if: "4.3" },
            "Journal of the Asia Pacific Economy": { q: "Q2", if: "1.5" },
            "Ambio": { q: "Q1", if: "6.5" },
            "Waste Management": { q: "Q1", if: "8.1" },
            "Nature Climate Change": { q: "Q1", if: "28.6" },
            "International Journal of Disaster Risk Reduction": { q: "Q1", if: "4.5" },
            "Feminist Economics": { q: "Q1", if: "2.2" },
            "Journal of Rural Studies": { q: "Q1", if: "5.3" },
            "International Forestry Review": { q: "Q2", if: "1.8" },
            "International Migration": { q: "Q2", if: "1.6" },
            "Corporate Social Responsibility and Environmental Management": { q: "Q1", if: "9.8" },
            "Research Policy": { q: "Q1", if: "8.2" },
            "Transportation Research Part D": { q: "Q1", if: "7.6" },
            "Journal of Cleaner Production": { q: "Q1", if: "11.1" },
            "Water International": { q: "Q2", if: "2.1" },
            "Science Communication": { q: "Q1", if: "3.5" },
            "Land Use Policy": { q: "Q1", if: "6.3" },
            "Development in Practice": { q: "Q2", if: "1.4" },
            "The Lancet": { q: "Q1", if: "168.9" },
            "Agricultural Systems": { q: "Q1", if: "6.6" },
            "The Journal of Portfolio Management": { q: "Q2", if: "1.8" },
            "MPRA Working Paper": { q: "Preprint", if: "-" },
            // Defaults
            "default": { q: "Q2", if: "2.4" }
        };

        // --- 3. APP STATE ---
        let allData = [];
        let filteredData = [];

        // --- 4. INITIALIZATION ---
        window.onload = function() {
            parseData(rawCSV);
        };

        // --- 5. DATA PROCESSING ---
        function parseData(csv) {
            Papa.parse(csv, {
                header: true,
                skipEmptyLines: true,
                complete: function(results) {
                    allData = results.data.map(enrichRow);
                    filteredData = [...allData];
                    populateFilters();
                    updateDashboard();
                }
            });
        }

        function enrichRow(row) {
            // 1. Bibliometrics (Mocked)
            const journal = row.journal ? row.journal.trim() : "";
            const metrics = journalMetrics[journal] || journalMetrics["default"];
            
            // 2. Identify Preprints
            const isPreprint = journal === "MPRA Working Paper" || journal.toLowerCase().includes("preprint");

            // 3. Identify Study Type (Review vs Empirical)
            const title = (row.title || "").toLowerCase();
            const abstract = (row.abstract_snippet || "").toLowerCase();
            let studyType = "Empirical";
            if (title.includes("review") || title.includes("meta-analysis") || title.includes("bibliometric") || abstract.includes("systematic review")) {
                studyType = "Review";
            } else if (isPreprint) {
                studyType = "Working Paper";
            }

            // 4. Identify Scope (Policy vs Firm)
            const sector = (row.sector || "").toLowerCase();
            let scope = "Firm-Level"; // Default
            if (sector.includes("policy") || sector.includes("finance") || title.includes("policy") || title.includes("national")) {
                scope = "Policy-Relevant";
            } else if (journal.includes("Business") || sector.includes("corporate") || sector.includes("production")) {
                scope = "Firm-Level";
            }

            return {
                ...row,
                scopusQ: isPreprint ? "N/A" : metrics.q,
                impactFactor: metrics.if,
                studyType: studyType,
                scope: scope,
                isPreprint: isPreprint
            };
        }

        // --- 6. FILTER LOGIC ---
        function populateFilters() {
            const regions = [...new Set(allData.map(d => d.region).filter(Boolean))].sort();
            const sectors = [...new Set(allData.map(d => d.sector).filter(Boolean))].sort();
            const years = [...new Set(allData.map(d => d.publication_year).filter(Boolean))].sort().reverse();

            populateSelect('regionFilter', regions);
            populateSelect('sectorFilter', sectors);
            populateSelect('yearFilter', years);

            // Add event listeners
            document.getElementById('searchInput').addEventListener('input', applyFilters);
            document.getElementById('regionFilter').addEventListener('change', applyFilters);
            document.getElementById('sectorFilter').addEventListener('change', applyFilters);
            document.getElementById('yearFilter').addEventListener('change', applyFilters);
            document.getElementById('scopeFilter').addEventListener('change', applyFilters);
        }

        function populateSelect(id, options) {
            const select = document.getElementById(id);
            options.forEach(opt => {
                const el = document.createElement('option');
                el.value = opt;
                el.textContent = opt;
                select.appendChild(el);
            });
        }

        function applyFilters() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const region = document.getElementById('regionFilter').value;
            const sector = document.getElementById('sectorFilter').value;
            const year = document.getElementById('yearFilter').value;
            const scope = document.getElementById('scopeFilter').value;

            filteredData = allData.filter(d => {
                const matchesSearch = (d.title || "").toLowerCase().includes(search) || 
                                      (d.abstract_snippet || "").toLowerCase().includes(search);
                const matchesRegion = region === "All" || d.region === region;
                const matchesSector = sector === "All" || d.sector === sector;
                const matchesYear = year === "All" || d.publication_year == year;
                const matchesScope = scope === "All" || d.scope === scope;

                return matchesSearch && matchesRegion && matchesSector && matchesYear && matchesScope;
            });

            updateDashboard();
        }

        // --- 7. UI UPDATES ---
        function updateDashboard() {
            renderTable();
            updateStats();
        }

        function updateStats() {
            // Count
            document.getElementById('countDisplay').textContent = filteredData.length;
            document.getElementById('statTotal').textContent = filteredData.length;

            // Avg Impact Factor (calculated from filtered data)
            let totalIF = 0;
            let countIF = 0;
            filteredData.forEach(d => {
                const val = parseFloat(d.impactFactor);
                if (!isNaN(val)) {
                    totalIF += val;
                    countIF++;
                }
            });
            const avg = countIF > 0 ? (totalIF / countIF).toFixed(2) : "0.0";
            document.getElementById('statImpact').textContent = avg;

            // Top Region
            if (filteredData.length > 0) {
                const regionCounts = {};
                filteredData.forEach(d => { regionCounts[d.region] = (regionCounts[d.region] || 0) + 1; });
                const topRegion = Object.keys(regionCounts).reduce((a, b) => regionCounts[a] > regionCounts[b] ? a : b);
                document.getElementById('statRegion').textContent = topRegion;
            } else {
                document.getElementById('statRegion').textContent = "-";
            }
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            if (filteredData.length === 0) {
                document.getElementById('emptyState').classList.remove('hidden');
                return;
            } else {
                document.getElementById('emptyState').classList.add('hidden');
            }

            filteredData.forEach(d => {
                const tr = document.createElement('tr');
                tr.className = "hover:bg-slate-50 transition-colors border-b border-slate-50 last:border-0";
                
                // Badges
                const qBadge = d.scopusQ === 'Q1' ? `<span class="badge badge-q1">Q1</span>` : 
                               d.scopusQ === 'Q2' ? `<span class="badge badge-q2">Q2</span>` : 
                               `<span class="badge bg-slate-100 text-slate-500 border border-slate-200">${d.scopusQ}</span>`;
                
                const typeBadgeColor = d.studyType === 'Review' ? 'bg-purple-100 text-purple-700 border-purple-200' : 
                                       d.studyType === 'Working Paper' ? 'bg-orange-100 text-orange-700 border-orange-200' :
                                       'bg-blue-50 text-blue-700 border-blue-100';

                const scopeIcon = d.scope === 'Policy-Relevant' ? '<i class="fa-solid fa-landmark mr-1"></i>' : '<i class="fa-solid fa-building mr-1"></i>';

                tr.innerHTML = `
                    <td class="px-6 py-4">
                        <div class="font-bold text-slate-800 text-sm leading-snug mb-1">${d.title}</div>
                        <div class="flex items-center gap-2 text-xs text-slate-500 mt-1">
                            <span class="bg-slate-100 px-2 py-0.5 rounded text-slate-600 font-mono">${d.publication_year}</span>
                            <span class="italic truncate max-w-[180px]" title="${d.journal}">${d.journal}</span>
                            ${d.isPreprint ? '<span class="badge badge-preprint text-[10px] uppercase tracking-wide">Preprint</span>' : ''}
                        </div>
                    </td>
                    <td class="px-4 py-4 align-top">
                        <div class="flex flex-col gap-1 items-start">
                            ${qBadge}
                            <span class="text-xs text-slate-400 font-mono">IF: ${d.impactFactor}</span>
                        </div>
                    </td>
                    <td class="px-4 py-4 align-top">
                        <div class="flex flex-col gap-2 items-start">
                            <span class="badge ${typeBadgeColor} border">${d.studyType}</span>
                            <span class="text-xs text-slate-500 font-medium flex items-center">${scopeIcon} ${d.scope}</span>
                        </div>
                    </td>
                    <td class="px-4 py-4 text-sm text-slate-600 align-top">${d.region}</td>
                    <td class="px-4 py-4 text-sm text-slate-600 align-top max-w-[120px] truncate" title="${d.sector}">${d.sector}</td>
                    <td class="px-4 py-4 text-right align-top">
                        ${d.doi || d.url ? 
                          `<a href="${d.url || 'https://doi.org/'+d.doi}" target="_blank" class="text-slate-400 hover:text-emerald-600 transition-colors p-2"><i class="fa-solid fa-external-link-alt"></i></a>` 
                          : ''}
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // --- 8. EXPORT FEATURE ---
        function exportCSV() {
            // Unparse the filtered data to CSV
            const csv = Papa.unparse(filteredData);
            
            // Create a blob and download
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.setAttribute("href", url);
            link.setAttribute("download", "green_database_export.csv");
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

    </script>
</body>
</html>
